<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ú–æ—Ä—Å–∫–æ–π –ë–æ–π: –°—Ç–∞—Ä—Ç</title>
    <link rel="shortcut icon" href="media/facion.png" type="image/x-icon" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body class="start-page">
    <video autoplay muted loop playbackrate="0.5" class="start-video" style="animation: none">
      <source src="media/downloaded-file.mp4" type="video/mp4" />
    </video>

    <audio id="bg-music" loop>
      <source src="media/fon.mp3" type="audio/mpeg" />
    </audio>

    <div class="start-container">
      <div class="start-card">
        <h1 class="start-title">–ú–û–†–°–ö–û–ô –ë–û–ô</h1>
        <p class="start-subtitle">–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞</p>

        <div class="start-divider"></div>

        <div class="game-mode-section">
          <h2 style="margin-bottom: 30px; font-size: 28px; color: #ffd700">–í–´–ë–ï–†–ò–¢–ï –†–ï–ñ–ò–ú –ò–ì–†–´:</h2>

          <button class="start-btn start-btn-primary" onclick="startGame2Teams()">
            üë• –î–í–ê –ò–ì–†–û–ö–ê
          </button>

          <button
            class="start-btn start-btn-secondary"
            onclick="startGameSingle()"
            disabled
            title="–†–µ–∂–∏–º –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
          >
            üë§ –õ–ò–ß–ù–ê–Ø –ò–ì–†–ê
          </button>
        </div>

        <div class="start-divider"></div>

        <div class="team-select-section" id="team-select-section" style="display: none">
          <h3 style="margin-bottom: 20px; color: #ffd700">–° –ö–ê–ö–û–ô –ö–û–ú–ê–ù–î–´ –ù–ê–ß–ò–ù–ê–¢–¨?</h3>
          <div class="team-buttons">
            <button class="team-btn team-btn-blue" onclick="selectStartTeam(1)">
              <span style="font-size: 24px">üîµ</span> –°–ò–ù–ò–ô –§–õ–û–¢
            </button>
            <button class="team-btn team-btn-red" onclick="selectStartTeam(2)">
              <span style="font-size: 24px">üî¥</span> –ö–†–ê–°–ù–´–ô –§–õ–û–¢
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å/–ó–∞–Ω–æ–≤–æ -->
    <div
      id="continue-modal"
      class="modal-overlay"
      style="display: none; z-index: 3000; background: rgba(0, 0, 0, 0.9)"
    >
      <div
        class="modal-content"
        style="
          max-width: 500px;
          background: #f4e4bc;
          color: #2c3e50;
          padding: 40px;
          border-radius: 20px;
          border: 8px solid #3e2723;
          box-shadow: 0 0 50px #000;
          position: relative;
        "
      >
        <h2 style="color: #ffd700; margin: 0 0 30px 0; font-size: 28px; text-align: center">
          üéÆ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è –∏–≥—Ä–∞
        </h2>
        <p style="font-size: 18px; margin-bottom: 30px; text-align: center; color: #2c3e50">
          –í—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–≥—Ä—É –∏–ª–∏ –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ?
        </p>
        <div style="display: flex; gap: 15px">
          <button
            class="btn btn-show"
            onclick="continuePreviousGame()"
            style="
              flex: 1;
              background: #2e7d32;
              font-size: 16px;
              color: white;
              padding: 12px 25px;
              cursor: pointer;
              font-weight: bold;
              border-radius: 30px;
              text-transform: uppercase;
              border: none;
              width: auto;
            "
          >
            üìñ –ü–†–û–î–û–õ–ñ–ò–¢–¨
          </button>
          <button
            class="btn btn-show"
            onclick="startNewGame()"
            style="
              flex: 1;
              background: #c62828;
              font-size: 16px;
              color: white;
              padding: 12px 25px;
              cursor: pointer;
              font-weight: bold;
              border-radius: 30px;
              text-transform: uppercase;
              border: none;
              width: auto;
            "
          >
            üîÑ –ó–ê–ù–û–í–û
          </button>
        </div>
      </div>
    </div>

    <script>
      // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç—å—é –≤–∏–¥–µ–æ –∏ –º—É–∑—ã–∫–æ–π
      window.addEventListener('load', () => {
        const video = document.querySelector('.start-video');
        const bgMusic = document.getElementById('bg-music');

        // –ó–∞–º–µ–¥–ª—è–µ–º –≤–∏–¥–µ–æ –≤ 2 —Ä–∞–∑–∞
        if (video) {
          video.playbackRate = 0.5;
          console.log('üìπ –í–∏–¥–µ–æ –∑–∞–º–µ–¥–ª–µ–Ω–æ –≤ 2 —Ä–∞–∑–∞');
        }

        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º —Ñ–æ–Ω–æ–≤—É—é –º—É–∑—ã–∫—É
        if (bgMusic) {
          bgMusic.volume = 0.3; // 30% –≥—Ä–æ–º–∫–æ—Å—Ç–∏
          bgMusic.play().catch((e) => console.log('Auto-play –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω:', e));
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –∏–≥—Ä—ã
        checkForSavedGame();
      });

      // –†–∞–∑—Ä–µ—à–∏—Ç—å –∞–≤—Ç–æ–ø–ª–µ–π –ø—Ä–∏ –∫–ª–∏–∫–µ
      document.addEventListener('click', () => {
        const bgMusic = document.getElementById('bg-music');
        if (bgMusic && bgMusic.paused) {
          bgMusic.play();
        }
      });

      function checkForSavedGame() {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º localStorage –∏ cookie –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –∏–≥—Ä—ã
        const savedLocal = localStorage.getItem('navy_battle_save');
        let savedCookie = null;

        try {
          const m = document.cookie.match(/(?:^|; )navy_battle_save=([^;]+)/);
          if (m) {
            savedCookie = decodeURIComponent(m[1]);
          }
        } catch (e) {
          console.log('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ cookie:', e);
        }

        // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è –∏–≥—Ä–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        if (savedLocal || savedCookie) {
          console.log('üéÆ –ù–∞–π–¥–µ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è –∏–≥—Ä–∞');
          document.getElementById('continue-modal').style.display = 'flex';
        }
      }

      function continuePreviousGame() {
        // –ü—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É (—Ç–∞–º –∑–∞–≥—Ä—É–∑—è—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
        console.log('üìñ –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é –∏–≥—Ä—É');
        window.location.href = 'main.html';
      }

      function startNewGame() {
        // –û—á–∏—â–∞–µ–º –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        console.log('üîÑ –ù–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—É—é –∏–≥—Ä—É');

        // –û—á–∏—â–∞–µ–º localStorage
        try {
          localStorage.removeItem('navy_battle_save');
          console.log('‚úì localStorage –æ—á–∏—â–µ–Ω');
        } catch (e) {
          console.warn('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ localStorage:', e);
        }

        // –û—á–∏—â–∞–µ–º cookie
        try {
          document.cookie = 'navy_battle_save=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/';
          console.log('‚úì Cookie –æ—á–∏—â–µ–Ω—ã');
        } catch (e) {
          console.warn('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ cookie:', e);
        }

        // –°–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –∫–æ–º–∞–Ω–¥—ã
        document.getElementById('continue-modal').style.display = 'none';
        document.getElementById('team-select-section').style.display = 'block';
      }

      function startGame2Teams() {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –∫–æ–º–∞–Ω–¥—ã
        document.getElementById('team-select-section').style.display = 'block';
      }

      function selectStartTeam(teamNum) {
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–æ–º–∞–Ω–¥—É –≤ localStorage
        localStorage.setItem('navy_battle_start_team', teamNum);
        // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –æ—Å–Ω–æ–≤–Ω—É—é –∏–≥—Ä–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
        window.location.href = 'main.html';
      }

      function startGameSingle() {
        alert('–†–µ–∂–∏–º –ª–∏—á–Ω–æ–π –∏–≥—Ä—ã (–æ–¥–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞) –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
      }
    </script>
  </body>
</html>
